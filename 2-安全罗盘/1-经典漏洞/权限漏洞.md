权限管理漏洞
智能合约中的权限管理定义了不同角色在应用中的权限。通常来说，代币的铸造、提取资金、暂停等功能都需要较高权限的用户才能调用。如果权限配置错误，就可能造成意想不到的损失。下面我们介绍两种常见的权限管理漏洞。


预防办法
权限管理漏洞主要有两种预防办法：

使用 Openzeppelin 的权限管理库给合约的特殊函数配置相应的权限，比如使用OnlyOwner修饰器，只有合约所有者才能调用。
// 正确的mint函数，使用 onlyOwner 修饰器限制权限
function goodMint(address to, uint amount) public onlyOwner {
    _mint(to, amount);
}
在函数的逻辑中确保合约调用者拥有足够的授权。
// 正确的burn函数，如果销毁的不是自己的代币，则会检查授权
function goodBurn(address account, uint amount) public {
    if(msg.sender != account){
        _spendAllowance(account, msg.sender, amount);
    }
    _burn(account, amount);
}

总结

智能合约中的权限管理漏洞。它主要有两种形式：权限配置错误和授权检查错误。为了避免这类漏洞，我们要使用权限管理库给特殊函数配置相应的权限，并且在函数的逻辑中确保合约调用者拥有足够的授权。